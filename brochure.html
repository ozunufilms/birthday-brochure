<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Birthday Brochure Smooth Zoom Flipbook</title>
<style>
body, html {
  margin:0;
  padding:0;
  width:100%;
  height:100%;
  background:#000;
  overflow:hidden;
  touch-action:none;
  font-family: system-ui,sans-serif;
}
.book {
  position:relative;
  width:100vw;
  height:100vh;
  overflow:hidden;
}
.page {
  position:absolute;
  width:100%;
  height:100%;
  top:0; left:0;
  display:flex;
  align-items:center;
  justify-content:center;
  transition: transform 0.4s ease;
}
.page img {
  width:100%;
  height:100%;
  object-fit:contain;
  transition: transform 0.2s ease;
  touch-action:none;
}
.page-counter {
  position:absolute;
  bottom:16px;
  width:100%;
  text-align:center;
  color:white;
  font-size:1rem;
  pointer-events:none;
}
</style>
</head>
<body>

<div class="book" id="book">
  <div class="page"><img src="brochure_images/page_1.jpg"></div>
  <div class="page"><img src="brochure_images/page_2.jpg"></div>
  <div class="page"><img src="brochure_images/page_3.jpg"></div>
  <div class="page"><img src="brochure_images/page_4.jpg"></div>
  <div class="page"><img src="brochure_images/page_5.jpg"></div>
  <!-- Add remaining pages up to 53 -->
</div>

<div class="page-counter" id="pageCounter">Page 1 / 53</div>

<script>
const pages = document.querySelectorAll('.page');
const pageCounter = document.getElementById('pageCounter');
let current = 0;

// Initialize page positions
pages.forEach((p,i)=>p.style.transform=`translateX(${i===0?0:100}%)`);
function updateCounter(){ pageCounter.textContent=`Page ${current+1} / ${pages.length}`; }
updateCounter();

// Navigation and gestures
let startX=0, startY=0, isDragging=false;
let imgScale = 1, lastScale=1;
let posX=0, posY=0, lastX=0, lastY=0;
let pointers = [];

const book = document.getElementById('book');
const img = () => pages[current].querySelector('img');

// Swipe only if not zoomed
function showPage(index){
  pages.forEach((p,i)=>p.style.transform=i<index?'translateX(-100%)':i===index?'translateX(0%)':'translateX(100%)');
  imgScale=1; lastScale=1; posX=0; posY=0;
  img().style.transform=`translate(0px,0px) scale(1)`;
  current=index;
  updateCounter();
}

// Touch start
book.addEventListener('touchstart', e=>{
  if(e.touches.length===1){
    startX = e.touches[0].clientX - lastX;
    startY = e.touches[0].clientY - lastY;
  } else if(e.touches.length===2){
    const [t1,t2] = e.touches;
    pointers = [t1,t2];
    pointers.startDist = Math.hypot(t2.clientX-t1.clientX, t2.clientY-t1.clientY);
    pointers.startScale = imgScale;
    pointers.centerX = (t1.clientX+t2.clientX)/2;
    pointers.centerY = (t1.clientY+t2.clientY)/2;
  }
});

// Touch move
book.addEventListener('touchmove', e=>{
  e.preventDefault();
  if(e.touches.length===1 && imgScale===1){
    // horizontal swipe for page
    const dx = e.touches[0].clientX - startX;
    if(dx>50) prevPage();
    if(dx<-50) nextPage();
  } else if(e.touches.length===2){
    // pinch zoom
    const [t1,t2] = e.touches;
    const dist = Math.hypot(t2.clientX-t1.clientX, t2.clientY-t1.clientY);
    let scale = pointers.startScale * (dist / pointers.startDist);
    scale = Math.min(Math.max(1, scale),3);
    imgScale=scale;

    // compute translation to zoom around pinch center
    const rect = img().getBoundingClientRect();
    const dx = pointers.centerX - rect.left - rect.width/2;
    const dy = pointers.centerY - rect.top - rect.height/2;

    const tx = posX + dx*(scale/lastScale -1);
    const ty = posY + dy*(scale/lastScale -1);

    img().style.transform=`translate(${tx}px,${ty}px) scale(${scale})`;
  }
});

// Touch end
book.addEventListener('touchend', e=>{
  lastScale=imgScale;
  if(imgScale===1){ posX=0; posY=0; img().style.transform='scale(1)'; }
});

// Double tap to zoom
let lastTap=0;
book.addEventListener('touchend', e=>{
  const now = Date.now();
  if(now-lastTap<300){
    if(imgScale===1){
      imgScale=2;
      img().style.transform=`translate(0px,0px) scale(2)`;
    } else{
      imgScale=1;
      posX=0; posY=0;
      img().style.transform=`translate(0px,0px) scale(1)`;
    }
  }
  lastTap=now;
});

// Page functions
function nextPage(){ if(current<pages.length-1) showPage(current+1); else window.location.href='closing.html'; }
function prevPage(){ if(current>0) showPage(current-1); }

// Initialize
showPage(0);
</script>

</body>
</html>
